{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to ESPHome 3D Printer Smart Enclosure","text":"<p>This is a 3d printer enclosure controlling system using esp32 devices using esphome via HomeAssistant.</p> <p>This is and probably always be a slow work in progress project as a hobby.</p>"},{"location":"architecture/","title":"Architecture","text":"<p>Well, for now this is more kind of a mind map anyway :D</p> mindmap   root[HomeAssistant]      esp32-dev-alpha       (send data about temperature/humidity)       (send data about particulate)       (send data about smoke alarm trigger)      esp32-dev-beta       (relay control fan)       (relay control leds)      esp32-dev-charlie       (get pictures of the print bed)       (take picture magnetic button)       (printer is printing led)       (picture taken led)      esp32-dev-delta       (gather data about spool weight)      esp32-dev-echo       (display data on the LCD)       (use touch display to control relays via esp32-dev-beta)  <p>Generally I have few different esp32 devices with senors connected to HomeAssistant. Thus another device can fetch objects from HomeAssistant and process/control them.</p> <p>Example:</p> <ul> <li>particulate matter sensor and calculating the generic value depending on the factors   assuming the smaller the particulate the worse air conditions</li> <li>temperature and humidity sensors</li> <li>on/off power of the printer, lights and fans</li> <li>automatic fan on/off if the particulate level is too high + delay for additional ventilation delay</li> </ul> <p>TODO: decrease number of esp32 devices :D</p>"},{"location":"featuers/","title":"Features","text":"<p>List of already implemented features:</p> <ul> <li>ugly dark theme :)</li> <li> <p>horrid lack of esphome packages and substitutions :)</p> </li> <li> <p>temperature / humidity sensor - gather data from the enclosure and expose in HA</p> </li> <li> <p>air particulate sensor - gather data from the enclosure and expose in HA</p> </li> <li> <p>auto switch to the default overall air quality on idle</p> </li> <li> <p>power off the display if quailty is SUPER</p> </li> <li> <p>power back the display brightness if quality gets worse</p> </li> <li> <p>relay switches   for printer power and light control</p> </li> <li> <p>set brightness based on the air condition status, so you are aware when it is bad</p> </li> <li> <p>show HA status if not connected - avoid clicking dead buttons</p> </li> </ul> <p></p> <ul> <li>buttons to control lights of the enclosure and the printer power</li> </ul> <p></p> <ul> <li>printer power control, use messagebox for confirmation</li> </ul> <p></p> <ul> <li>generate git version and bake it into the first tile, easier to track different devices</li> </ul>"},{"location":"known_limitations/","title":"Known limitations","text":"<ul> <li> <p>for smooth transitions esp32 device with PSRAM recommended,   notice that esp8266 was not tested at all and probably will never be</p> </li> <li> <p>you may need two boards, one for the display and another for other controls due to pinout limits... and convenience</p> </li> </ul>"},{"location":"requirements/","title":"Requirements","text":"<ul> <li>HomeAssistant</li> <li>esphome compatible boards such as esp32-wrover or newer (esp32 with PSRAM recommended)</li> <li>LCD display (recommended with touch)</li> <li>temperature / humidity sensor</li> <li>air particulate sensor</li> </ul>"},{"location":"requirements/#bill-of-materials","title":"Bill Of Materials","text":"<ul> <li><code>esp-wroom-32</code> - ESP32 wroom 32 or similiar</li> <li>temperature/humidity - AHT10 compatible device, for example AHT20</li> <li>particulate matter sensor compatible with PMSX003</li> <li>LCD display - now I am using Waveshare 1.69inch touch LCD</li> <li>Gridfinity LCD enclosure</li> </ul>"},{"location":"todo/","title":"Todo","text":""},{"location":"todo/#general","title":"General","text":"<ul> <li>TODO: if air quality gets worse and backlight is on, then it is not off on idle , need to touch screen</li> <li>TODO: use esphome packages and substitutions, everything is hardcoded now and some overrides are dumb</li> <li>TODO: show print progress bar overlay?</li> <li> <p>TODO: show ETA for air cleanup, how to calculate it?</p> </li> <li> <p>BUG: sometimes display is always on and needs to be touched to allow it to turn off to 0   add global value to check the screen idle and last time it was on/off?</p> </li> <li>TODO: LCD backlight based on ambient light and printer printing status? would require light sensor   or activate via ToF is someone is near the printer, can be issue with the doors of the cabinet, though</li> </ul>"},{"location":"todo/#control-power-of-the-printer-and-lights","title":"Control power of the printer and lights","text":"<ul> <li> <p>right now external smart socket is used to power the printer on/off, this stays as is I guess</p> </li> <li> <p>replace relay switches with MOSFET switches for fan and light control to allow   speed control and brightness adjustments similar as   rudd-o did it. Use for example HW-532 = mosfet with opto-isolation</p> </li> </ul>"},{"location":"todo/#control-air-quality","title":"Control air quality","text":"<ul> <li> <p>TODO: add fan with filter such as nevermore3d system</p> </li> <li> <p>TODO: filter usage (fan time * fan speed)</p> </li> <li> <p>TODO: other air quality sensors - for detecting gases when printing other materials such as ABS/ASA (not tested)   and calculate it based on this   or that   and this</p> </li> </ul> <p><pre><code>Label              | IAQI      | CO2(ppm)    | TVOC(Index)  | NOx(Index) | CH2O(ppm)  | PM1(\u00b5g/m3) | PM2.5(\u00b5g/m3) | PM10(\u00b5g/m3) | CO(ppm)     | O3(ppm)        |\n---------------------------------------------------------------------------------------------------------------------------------------------------------------\nGood               |   0 - 100 |  400 -  599 |     1 -  199 |    1 - 49  |   0 -   50 |     0 - 14 |      0 - 20  |     0 -  30 |  0   -  1.7 | 0 - 0.025      |\nModerate           | 101 - 200 |  600 - 999  |   200 -  660 |   50 - 99  |  51 -  150 |    15 - 34 |     21 - 50  |    31 -  75 |  1.8 -  8.7 | 0.026 - 0.06   |\nPolluted           | 201 - 300 | 1000 - 1499 |   661 - 1100 |  100 - 299 | 151 -  300 |    35 - 61 |     51 - 90  |    76 - 125 |  8.8 - 10   | 0.061 - 0.075  |\nVery Polluted      | 301 - 400 | 1500 - 2499 |  1101 - 1651 |  300 - 349 | 301 -  500 |    62 - 95 |     91 - 140 |   126 - 200 | 10.1 - 15   | 0.076 - 0.1    |\nSeverely Polluted  | 401 - 500 | 2500 - 5000 |  1651 - 2000 |  350 - 500 | 501 - 1000 |   96 - 150 |    141 - 200 |   201 - 300 | 15.1 - 30   | 0.101 - 0.3    |\n</code></pre> </p>"},{"location":"todo/#spool-weight-sensor","title":"Spool weight sensor","text":"<ul> <li>for knowing how much filament you have left on the spool so you can decide what to print without   the need to install a new spool, later on to integrate with filament usage   but this needs zeroing the weight based on the spool type so you need to know the empty spool weight.</li> </ul>"},{"location":"why/","title":"Why","text":"<p>I have a 3d printer with an enclosure in an appartment where it is hard to make a proper air ventilation to have a constant negative pressure in the 3d enclosure so that air polluted during printing can be sent outside of an apartment.</p> <p>This means that I need to use air cleaning setup and also provide a feedback to the user that it may be not a good idea to open the enclosure if the air quality inside is not good.</p> <ul> <li> <p>nervermore-controller was an inspiration(used with nevermore mini), but I already had a setup with HomeAssistant/Node-Red and esp32 devices all around with ESPHome and thus I did not feel I want custom firmware on the device just for air control of the 3d printer enclosure.</p> </li> <li> <p>Rudd-O blog and related Rudd-O/prusa-mk4-smart-enclosure also did some smart enclosure but it did not fit my needs, but there is a lot of great things in there to use.</p> </li> <li> <p>tuct/smart-control-for-prusa-enclosure also looks interesting as a source of automation etc.</p> </li> <li> <p>RyanEwen/esphome-lvgl/ awesome esphome includes, must see.</p> </li> </ul> <p>All in all this project was born.</p>"}]}